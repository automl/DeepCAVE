<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>deepcave.evaluators.mo_lpi &#8212; DeepCAVE Documentation 1.3.3 documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ac9c05f7c49ca1e1f876c6e36360ea26.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2eb4fb78" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.9ea38e314b9e6d9dab77.js">

    <script src="../../../_static/documentation_options.js?v=c35e6b01"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
  <a class="navbar-brand" href="../../../index.html">
  <!-- <p class="title">DeepCAVE Documentation</p> -->
  </a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/automl/DeepCAVE" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/automl_org?lang=de" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown mt-1">
    <button type="button" class="btn btn-secondary btn-md navbar-btn dropdown-toggle" id="dLabelMore"
        data-toggle="dropdown">
        v1.3.3
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action" href="#">v1.3.3</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search align-items-center" action="../../../search.html" method="get" style="width: 100%;">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control btn btn-md" name="q" id="search-input"
    placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><h4 class="mt-0 mb-0"><a href="../../../index.html">DeepCAVE Documentation</a></h4>
<div class="mb-3">v1.3.3</div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../examples/index.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../examples/api/index.html">
     API
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/api/pdp.html">
       Partial Dependencies
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/api/parallel_coordinates.html">
       Parallel Coordinates
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/api/importances.html">
       Importances
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/api/ablation_paths.html">
       Ablation Paths
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../examples/record/index.html">
     Record
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/record/minimal.html">
       Record Minimal Run
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/record/digits_sklearn.html">
       Multi-Layer Perceptron via Sklearn
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../examples/record/mnist_pytorch.html">
       Multi-Layer Perceptron via PyTorch
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../plugins/index.html">
   Displaying Data with Plugins
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/configurations.html">
     Configurations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/configuration_footprint.html">
     Configuration Footprint
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/cost_over_time.html">
     Cost Over Time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/pareto_front.html">
     Pareto Front
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/budget_correlation.html">
     Budget Correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/importances.html">
     Importances
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/ablation_paths.html">
     Ablation Paths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/configuration_cube.html">
     Configuration Cube
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/parallel_coordinates.html">
     Parallel Coordinates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/partial_dependencies.html">
     Partial Dependencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/symbolic_explanations.html">
     Symbolic Explanations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../plugins/custom_plugins.html">
     Adding a Plugin
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../converters/index.html">
   Runs and Converters
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/smac.html">
     SMAC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/amltk.html">
     AMLTK
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/optuna.html">
     Optuna
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/bohb.html">
     BOHB
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/deepcave.html">
     DeepCAVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/dataframe.html">
     Pandas DataFrame
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../converters/custom_converters.html">
     Adding a Converter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../how_to_contribute.html">
   How to Contribute
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../api.html">
   API References
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../api/deepcave.runs.html">
     deepcave.runs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../api/deepcave.runs.converters.html">
       deepcave.runs.converters
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.amltk.html">
         deepcave.runs.converters.amltk
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.bohb.html">
         deepcave.runs.converters.bohb
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.dataframe.html">
         deepcave.runs.converters.dataframe
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.deepcave.html">
         deepcave.runs.converters.deepcave
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.optuna.html">
         deepcave.runs.converters.optuna
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.smac3v1.html">
         deepcave.runs.converters.smac3v1
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.runs.converters.smac3v2.html">
         deepcave.runs.converters.smac3v2
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.exceptions.html">
       deepcave.runs.exceptions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.group.html">
       deepcave.runs.group
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.handler.html">
       deepcave.runs.handler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.objective.html">
       deepcave.runs.objective
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.recorder.html">
       deepcave.runs.recorder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.run.html">
       deepcave.runs.run
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.status.html">
       deepcave.runs.status
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.runs.trial.html">
       deepcave.runs.trial
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../api/deepcave.plugins.html">
     deepcave.plugins
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.plugins.budget.html">
       deepcave.plugins.budget
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.plugins.dynamic.html">
       deepcave.plugins.dynamic
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.html">
       deepcave.plugins.hyperparameter
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.ablation_paths.html">
         deepcave.plugins.hyperparameter.ablation_paths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.configuration_cube.html">
         deepcave.plugins.hyperparameter.configuration_cube
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.importances.html">
         deepcave.plugins.hyperparameter.importances
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.parallel_coordinates.html">
         deepcave.plugins.hyperparameter.parallel_coordinates
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.pdp.html">
         deepcave.plugins.hyperparameter.pdp
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.hyperparameter.symbolic_explanations.html">
         deepcave.plugins.hyperparameter.symbolic_explanations
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.plugins.objective.html">
       deepcave.plugins.objective
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.plugins.static.html">
       deepcave.plugins.static
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../api/deepcave.plugins.summary.html">
       deepcave.plugins.summary
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.summary.configurations.html">
         deepcave.plugins.summary.configurations
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.summary.footprint.html">
         deepcave.plugins.summary.footprint
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.plugins.summary.overview.html">
         deepcave.plugins.summary.overview
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../api/deepcave.layouts.html">
     deepcave.layouts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.layouts.header.html">
       deepcave.layouts.header
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.layouts.not_found.html">
       deepcave.layouts.not_found
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.layouts.sidebar.html">
       deepcave.layouts.sidebar
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../api/deepcave.evaluators.html">
     deepcave.evaluators
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.ablation.html">
       deepcave.evaluators.ablation
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../api/deepcave.evaluators.epm.html">
       deepcave.evaluators.epm
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.evaluators.epm.fanova_forest.html">
         deepcave.evaluators.epm.fanova_forest
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.evaluators.epm.random_forest.html">
         deepcave.evaluators.epm.random_forest
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.evaluators.epm.random_forest_surrogate.html">
         deepcave.evaluators.epm.random_forest_surrogate
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../api/deepcave.evaluators.epm.utils.html">
         deepcave.evaluators.epm.utils
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.fanova.html">
       deepcave.evaluators.fanova
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.footprint.html">
       deepcave.evaluators.footprint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.lpi.html">
       deepcave.evaluators.lpi
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.mo_ablation.html">
       deepcave.evaluators.mo_ablation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.mo_fanova.html">
       deepcave.evaluators.mo_fanova
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.evaluators.mo_lpi.html">
       deepcave.evaluators.mo_lpi
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../api/deepcave.utils.html">
     deepcave.utils
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.cache.html">
       deepcave.utils.cache
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.cast.html">
       deepcave.utils.cast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.compression.html">
       deepcave.utils.compression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.configs.html">
       deepcave.utils.configs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.configspace.html">
       deepcave.utils.configspace
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.converters.html">
       deepcave.utils.converters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.dash.html">
       deepcave.utils.dash
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.data_structures.html">
       deepcave.utils.data_structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.docs.html">
       deepcave.utils.docs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.files.html">
       deepcave.utils.files
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.hash.html">
       deepcave.utils.hash
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.layout.html">
       deepcave.utils.layout
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.logs.html">
       deepcave.utils.logs
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.multi_objective_importance.html">
       deepcave.utils.multi_objective_importance
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.notification.html">
       deepcave.utils.notification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.run_caches.html">
       deepcave.utils.run_caches
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.styled_plotty.html">
       deepcave.utils.styled_plotty
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.symbolic_regression.html">
       deepcave.utils.symbolic_regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.url.html">
       deepcave.utils.url
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../api/deepcave.utils.util.html">
       deepcave.utils.util
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../faq.html">
   Frequently Asked Questions
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for deepcave.evaluators.mo_lpi</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2021-2024 The DeepCAVE Authors</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#   http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="c1">#  noqa: D400</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># LPI</span>

<span class="sd">This module provides utilities to calculate the local parameter importance (LPI).</span>

<span class="sd">## Classes</span>
<span class="sd">    - LPI: This class calculates the local parameter importance (LPI).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ConfigSpace</span><span class="w"> </span><span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ConfigSpace.c_util</span><span class="w"> </span><span class="kn">import</span> <span class="n">change_hp_value</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ConfigSpace.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">impute_inactive_values</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">deepcave.evaluators.epm.fanova_forest</span><span class="w"> </span><span class="kn">import</span> <span class="n">FanovaForest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">deepcave.evaluators.lpi</span><span class="w"> </span><span class="kn">import</span> <span class="n">LPI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">deepcave.runs</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractRun</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">deepcave.runs.objective</span><span class="w"> </span><span class="kn">import</span> <span class="n">Objective</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">deepcave.utils.multi_objective_importance</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_weightings</span>


<span class="c1"># https://github.com/automl/ParameterImportance/blob/f4950593ee627093fc30c0847acc5d8bf63ef84b/pimp/evaluator/local_parameter_importance.py#L27</span>
<div class="viewcode-block" id="MOLPI">
<a class="viewcode-back" href="../../../api/deepcave.evaluators.mo_lpi.html#deepcave.evaluators.mo_lpi.MOLPI">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MOLPI</span><span class="p">(</span><span class="n">LPI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the multi-objective local parameter importance (LPI).</span>

<span class="sd">    Override: to train the random forest with an arbitrary weighting of the objectives</span>
<span class="sd">    (multi-objective case).</span>

<span class="sd">    Properties</span>
<span class="sd">    ----------</span>
<span class="sd">    run : AbstractRun</span>
<span class="sd">        The AbstractRun to get the importance from.</span>
<span class="sd">    cs : ConfigurationSpace</span>
<span class="sd">        The configuration space of the run.</span>
<span class="sd">    hp_names : List[str]</span>
<span class="sd">        The names of the Hyperparameters.</span>
<span class="sd">    variances : Dict[Any, list]</span>
<span class="sd">        The overall variances per tree.</span>
<span class="sd">    importances : dict</span>
<span class="sd">        The importances of the Hyperparameters.</span>
<span class="sd">    continuous_neighbors : int</span>
<span class="sd">        The number of neighbors chosen for continuous Hyperparameters.</span>
<span class="sd">    incumbent : Configuration</span>
<span class="sd">        The incumbent of the run.</span>
<span class="sd">    default : Configuration</span>
<span class="sd">        A configuration containing Hyperparameters with default values.</span>
<span class="sd">    incumbent_array : numpy.ndarray</span>
<span class="sd">        The internal vector representation of the incumbent.</span>
<span class="sd">    seed : int</span>
<span class="sd">        The seed. If not provided it will be random.</span>
<span class="sd">    rs : RandomState</span>
<span class="sd">        A random state with a given seed value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run</span><span class="p">:</span> <span class="n">AbstractRun</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importances</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="MOLPI.calculate">
<a class="viewcode-back" href="../../../api/deepcave.evaluators.mo_lpi.html#deepcave.evaluators.mo_lpi.MOLPI.calculate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">objectives</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Objective</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Objective</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">budget</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">continous_neighbors</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
        <span class="n">n_trees</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the data and train a RandomForest model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        objectives : Optional[Union[Objective, List[Objective]]], optional</span>
<span class="sd">            Considered objectives. By default, None. If None, all objectives are considered.</span>
<span class="sd">        budget : Optional[Union[int, float]], optional</span>
<span class="sd">            Considered budget. By default, None. If None, the highest budget is chosen.</span>
<span class="sd">        continuous_neighbors : int, optional</span>
<span class="sd">            How many neighbors should be chosen for continuous hyperparameters (HPs).</span>
<span class="sd">            By default, 500.</span>
<span class="sd">        n_trees : int, optional</span>
<span class="sd">            The number of trees for the fanova forest.</span>
<span class="sd">            Default is 10.</span>
<span class="sd">        seed : Optional[int], optional</span>
<span class="sd">            The seed. By default None. If None, a random seed is chosen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">get_objectives</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">budget</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">budget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">get_highest_budget</span><span class="p">()</span>

        <span class="c1"># Set variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continous_neighbors</span> <span class="o">=</span> <span class="n">continous_neighbors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">get_default_configuration</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Get data</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">get_encoded_data</span><span class="p">(</span>
            <span class="n">objectives</span><span class="o">=</span><span class="n">objectives</span><span class="p">,</span>
            <span class="n">budget</span><span class="o">=</span><span class="n">budget</span><span class="p">,</span>
            <span class="n">specific</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">include_combined_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">include_config_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># normalize objectives</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objectives</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="n">objectives_normed</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="p">:</span>
            <span class="n">normed</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_normed&quot;</span>
            <span class="n">df</span><span class="p">[</span><span class="n">normed</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">optimize</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="p">[</span><span class="n">normed</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">normed</span><span class="p">]</span>
            <span class="n">objectives_normed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normed</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">objectives_normed</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">hp_names</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span>
        <span class="n">weightings</span> <span class="o">=</span> <span class="n">get_weightings</span><span class="p">(</span><span class="n">objectives_normed</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

        <span class="c1"># calculate importance for each weighting generated from the pareto efficient points</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weightings</span><span class="p">:</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">*</span> <span class="n">weighting</span> <span class="k">for</span> <span class="n">obj</span><span class="p">,</span> <span class="n">weighting</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">objectives_normed</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="c1"># Use same forest as for fanova</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">FanovaForest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="p">,</span> <span class="n">n_trees</span><span class="o">=</span><span class="n">n_trees</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

            <span class="n">incumbent_cfg_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span> <span class="k">for</span> <span class="n">obj</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">objectives_normed</span><span class="p">,</span> <span class="n">w</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">incumbent_cfg_id</span><span class="p">][</span><span class="s2">&quot;config_id&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">incumbent_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span><span class="o">.</span><span class="n">get_array</span><span class="p">()</span>
            <span class="n">importances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_one_weighting</span><span class="p">()</span>
            <span class="n">df_res</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">df_res</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_all</span><span class="p">,</span> <span class="n">df_res</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importances</span> <span class="o">=</span> <span class="n">df_all</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;importance&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;variance&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;hp_name&quot;</span><span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">importances</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>  <span class="c1"># no negative values</span></div>


<div class="viewcode-block" id="MOLPI.calc_one_weighting">
<a class="viewcode-back" href="../../../api/deepcave.evaluators.mo_lpi.html#deepcave.evaluators.mo_lpi.MOLPI.calc_one_weighting">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calc_one_weighting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare the data after a model has be trained for one weighting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        imp_var_dict: Dict[str, Tuple[float, float]]</span>
<span class="sd">            Dictionary of importances and variances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get neighborhood sampled on an unit-hypercube.</span>
        <span class="n">neighborhood</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_neighborhood</span><span class="p">()</span>

        <span class="c1"># The delta performance is needed from the default configuration and the incumbent</span>
        <span class="n">def_perf</span><span class="p">,</span> <span class="n">def_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_mean_var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
        <span class="n">inc_perf</span><span class="p">,</span> <span class="n">inc_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_mean_var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span><span class="p">)</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">def_perf</span> <span class="o">-</span> <span class="n">inc_perf</span>

        <span class="c1"># These are used for plotting and hold the predictions for each neighbor of each parameter.</span>
        <span class="c1"># That means performances holds the mean, variances the variance of the forest.</span>
        <span class="n">performances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">variances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># These are used for importance and hold the corresponding importance/variance over</span>
        <span class="c1"># neighbors. Only import if NOT quantifying importance via performance-variance across</span>
        <span class="c1"># neighbors.</span>

        <span class="c1"># Nested list of values per tree in random forest.</span>
        <span class="n">predictions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Iterate over parameters</span>
        <span class="k">for</span> <span class="n">hp_idx</span><span class="p">,</span> <span class="n">hp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">hp_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">neighborhood</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">performances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">variances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">predictions</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">incumbent_added</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">incumbent_idx</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Iterate over neighbors</span>
            <span class="k">for</span> <span class="n">unit_neighbor</span><span class="p">,</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">incumbent_added</span><span class="p">:</span>
                    <span class="c1"># Detect incumbent</span>
                    <span class="k">if</span> <span class="n">unit_neighbor</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">incumbent_array</span><span class="p">[</span><span class="n">hp_idx</span><span class="p">]:</span>
                        <span class="n">performances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inc_perf</span><span class="p">)</span>
                        <span class="n">variances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inc_var</span><span class="p">)</span>
                        <span class="n">incumbent_added</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">incumbent_idx</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Create the neighbor-Configuration object</span>
                <span class="n">new_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">incumbent_array</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">new_array</span> <span class="o">=</span> <span class="n">change_hp_value</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="p">,</span> <span class="n">new_array</span><span class="p">,</span> <span class="n">hp_name</span><span class="p">,</span> <span class="n">unit_neighbor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">index_of</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">new_config</span> <span class="o">=</span> <span class="n">impute_inactive_values</span><span class="p">(</span><span class="n">Configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cs</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="n">new_array</span><span class="p">))</span>

                <span class="c1"># Get the leaf values</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_config</span><span class="o">.</span><span class="n">get_array</span><span class="p">())</span>
                <span class="n">leaf_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">get_leaf_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

                <span class="c1"># And the prediction/performance/variance</span>
                <span class="n">predictions</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tree_pred</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree_pred</span> <span class="ow">in</span> <span class="n">leaf_values</span><span class="p">])</span>
                <span class="n">performances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">variances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
                    <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">incumbent_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">incumbent_array</span><span class="p">[</span><span class="n">hp_idx</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
                    <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">incumbent_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incumbent_array</span><span class="p">[</span><span class="n">hp_idx</span><span class="p">])</span>
                <span class="n">neighborhood</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incumbent</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">incumbent_added</span><span class="p">:</span>
                <span class="n">performances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inc_perf</span><span class="p">)</span>
                <span class="n">variances</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inc_var</span><span class="p">)</span>

            <span class="c1"># Avoid division by zero</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Creating actual importance value (by normalizing over sum of vars)</span>
        <span class="n">num_trees</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hp_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">performances</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">overall_var_per_tree</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">hp_name</span> <span class="ow">in</span> <span class="n">hp_names</span><span class="p">:</span>
            <span class="n">hp_variances</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tree_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trees</span><span class="p">):</span>
                <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">([</span><span class="n">neighbor</span><span class="p">[</span><span class="n">tree_idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]])</span>
                <span class="n">hp_variances</span> <span class="o">+=</span> <span class="p">[</span><span class="n">variance</span><span class="p">]</span>

            <span class="n">overall_var_per_tree</span><span class="p">[</span><span class="n">hp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">hp_variances</span>

        <span class="c1"># Sum up variances per tree across parameters</span>
        <span class="n">sum_var_per_tree</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">sum</span><span class="p">([</span><span class="n">overall_var_per_tree</span><span class="p">[</span><span class="n">hp_name</span><span class="p">][</span><span class="n">tree_idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">hp_name</span> <span class="ow">in</span> <span class="n">hp_names</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">tree_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trees</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># Normalize</span>
        <span class="n">overall_var_per_tree</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">p</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">t</span> <span class="o">/</span> <span class="n">sum_var_per_tree</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">sum_var_per_tree</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trees</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">trees</span> <span class="ow">in</span> <span class="n">overall_var_per_tree</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">imp_var_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">overall_var_per_tree</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">overall_var_per_tree</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">overall_var_per_tree</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">imp_var_dict</span></div>


<div class="viewcode-block" id="MOLPI.get_importances_">
<a class="viewcode-back" href="../../../api/deepcave.evaluators.mo_lpi.html#deepcave.evaluators.mo_lpi.MOLPI.get_importances_">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_importances_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hp_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the importance scores from the passed Hyperparameter names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hp_names : Optional[List[str]]</span>
<span class="sd">            Selected Hyperparameter names to get the importance scores from. If None, all</span>
<span class="sd">            Hyperparameters of the configuration space are used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict</span>
<span class="sd">            Dictionary with Hyperparameter names and the corresponding importance scores and</span>
<span class="sd">            variances.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If the important scores are not calculated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">importances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Importance scores must be calculated first.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hp_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">importances</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">importances</span><span class="p">[</span><span class="s2">&quot;hp_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">hp_names</span><span class="p">)]</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">importances</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span></div>
</div>

</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.9ea38e314b9e6d9dab77.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2025, S. Segel and H. Graf and E. Bergman and K. Thieme and L. Fehring and A. Tornede and R. Sass and A. Biedenkapp and F. Hutter and M. Lindauer.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a>
7.4.7. Template is modified version of <a
href="https://pydata-sphinx-theme.readthedocs.io">PyData Sphinx Theme</a>. <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>